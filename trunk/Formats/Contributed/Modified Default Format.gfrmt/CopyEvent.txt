property INDIEventList : {"ADOP", "BAPL", "BAPM", "BARM", "BASM", "BIRT", "BLES", "BURI", "CAST", "CENS", "CHR", "CHRA", "CONF", "CONL", "CREM", "DEAT", "DSCR", "EDUC", "EMIG", "ENDL", "EVEN", "FCOM", "GRAD", "IDNO", "IMMI", "NATI", "NATU", "NCHI", "NMR", "OCCU", "ORDN", "PROB", "PROP", "REFN", "RELI", "RESI", "RETI", "SLGC", "SSN", "TITL", "WAC", "WILL"}property FAMEventList : {"ANUL", "CENS", "DIV", "DIVF", "ENGA", "MARB", "MARC", "MARL", "MARR", "MARS", "NCHI", "REFN"}tell application "GEDitCOM II"	set message visible to false	tell front document				set sourstruc to ""		set eventstruc to ""				set props to properties				try			set keyref to item 3 of (editing details of props)		on error			display dialog "You need to select a non blank field" buttons {"OK"} default button 1			return		end try				set keylevel to level of keyref		if keylevel is 1 then			set eventstruc to keyref		end if		if keylevel is 2 then			set eventstruc to parent structure of keyref		end if		if keylevel is 3 then			set eventstruc to parent structure of parent structure of keyref		end if		if keylevel is 4 then			set eventstruc to parent structure of parent structure of parent structure of keyref		end if		if keylevel is 5 then			set eventstruc to parent structure of parent structure of parent structure of keyref		end if	end tell		--set copydata to (gedcom of eventstruc) as string	--****************************Evenyually want to give choice of just copying the source but issues over pasting it correctly*************	--if sourstruc is not "" then	--set answer to the button returned of (display dialog "Do you just want to copy the source, or copy the whole event?" buttons {"Just Source", "Whole Event"} default button 2)	--if answer is "Just source" then	--set copydata to (gedcom of sourstruc) as string	--else	--set copydata to (gedcom of eventstruc) as string	--end if	--else		if eventstruc is "" or (name of eventstruc is not in INDIEventList and name of eventstruc is not in FAMEventList) then		display dialog "You have not selected an event to copy" buttons {"OK"}	else		set copydata to (gedcom of eventstruc) as string	end if		try		set the clipboard to copydata	end try	end tell